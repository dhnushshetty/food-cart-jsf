<!DOCTYPE html>
<html>
<head>
    <title>My Orders</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background: #f5f5f5; }
        .navbar { background: #2c3e50; color: white; padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center; }
        .navbar h1 { font-size: 1.5rem; }
        .navbar a { color: white; text-decoration: none; margin-left: 1rem; padding: 0.5rem 1rem; border-radius: 4px; }
        .navbar a:hover { background: #34495e; }
        .container { max-width: 1000px; margin: 2rem auto; padding: 0 2rem; }
        .order { background: white; padding: 1.5rem; margin-bottom: 1rem; border-radius: 4px; }
        .order h3 { margin-bottom: 1rem; }
        .status { padding: 0.5rem 1rem; border-radius: 4px; display: inline-block; }
        .PENDING { background: #fff3cd; color: #856404; }
        .PREPARING { background: #cce5ff; color: #004085; }
        .READY { background: #d4edda; color: #155724; }
        .DELIVERED { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <nav class="navbar">
        <h1>ðŸ“¦ My Orders</h1>
        <div>
            <a href="/shops">Browse Shops</a>
            <a href="/cart">Cart</a>
            <a href="#" onclick="logout()">Logout</a>
        </div>
    </nav>
    <div class="container" id="orders"></div>
    <script>
        const token = localStorage.getItem('token');
        if (!token) window.location.href = '/login';
        
        async function loadOrders() {
            const response = await fetch('/api/orders/my-history', {
                headers: { 'Authorization': 'Bearer ' + token }
            });
            const orders = await response.json();
            const container = document.getElementById('orders');
            
            if (orders.length === 0) {
                container.innerHTML = '<p>No orders yet</p>';
                return;
            }
            
            container.innerHTML = orders.map(function(order) {
                return '<div class="order">' +
                    '<h3>Order #' + order.id + ' - ' + order.shopName + '</h3>' +
                    '<p>Status: <span class="status ' + order.status + '">' + order.status + '</span></p>' +
                    '<p>Total: â‚¹' + order.totalAmount + '</p>' +
                    '<p>Date: ' + new Date(order.createdAt).toLocaleString() + '</p>' +
                    '<h4>Items:</h4>' +
                    '<ul>' +
                    order.items.map(function(item) {
                        return '<li>' + item.menuItemName + ' x ' + item.quantity + ' - â‚¹' + item.priceAtOrder + '</li>';
                    }).join('') +
                    '</ul>' +
                    '</div>';
            }).join('');
        }
        
        function logout() {
            localStorage.clear();
            window.location.href = '/';
        }
        
        loadOrders();
    </script>
</body>
</html>
